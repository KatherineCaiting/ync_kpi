package com.ync365.oa.web.satisfaction;

import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;

import com.ync365.commons.utils.CloneUtils;
import com.ync365.oa.bo.SatisfactionBo;
import com.ync365.oa.entity.Satisfaction;
import com.ync365.oa.query.SatisfactionQuery;
import com.ync365.oa.service.properties.PropertiesService;
import com.ync365.oa.service.satisfaction.SatisfactionService;

@Controller
@RequestMapping(value = "/satisfaction")
public class SatisfactionController {
	
	@Autowired
	private SatisfactionService satisfactionServic;
	
	@Autowired
	private PropertiesService propertiesService;
	
	@RequestMapping(value = "/list")
	public String list(Model model,SatisfactionQuery q) {
		Long userId = 1l;
		q.setProjectId(11l);
		List <Satisfaction> myEvaluateList = new ArrayList<Satisfaction>() ;//我评价的
		List<Satisfaction> myEvaluatedList = new ArrayList<Satisfaction>();//评价我的
		myEvaluateList = satisfactionServic.searchByEvaIdProId(userId,q.getProjectId());
		myEvaluatedList = satisfactionServic.searchByBeEvaIdProId(userId, q.getProjectId());
		model.addAttribute("myEvaluateList", myEvaluateList);
		model.addAttribute("myEvaluatedList", myEvaluatedList);
        return "satisfaction/satisfactionList";
	}
	@RequestMapping(value = "/editPage/{id}")
	public String editPage(Model model,SatisfactionQuery q) {
		Long id = 1l;
		Satisfaction satisfaction = satisfactionServic.findOne(id);
		SatisfactionBo satisfactionBo = new SatisfactionBo();
		CloneUtils.cloneObject(satisfaction, satisfactionBo);
		satisfactionBo.setScoreLimit(Double.parseDouble(String.valueOf(propertiesService.SATISFACTION_SCORE)));
		model.addAttribute("satisfaction",satisfaction);
        return "satisfaction/satisfactionEdit";
	}
	@RequestMapping(value = "/edit")
	public String editPage(Model model,Satisfaction satisfaction) {
		 satisfactionServic.update(satisfaction);
        return "satisfaction/satisfactionList";
	}
}
